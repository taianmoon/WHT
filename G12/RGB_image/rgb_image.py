#DO FIRST on command line
#export PATH=$PATH:$HOME/Downloads/montage/bin

import os
import pyfits
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import math
import montage_wrapper as montage
from astropy.io import fits
import matplotlib.cm as cm
import aplpy
import matplotlib.lines as ln


#========================================================HERE============================================

input_fits_image_band1='./input/shift_i_gama12_ks_2h_20160225_astro_2mass_0p25rms.fits'
input_fits_image_band2='./input/shift_gama12_j_1h12m_20160225_astro_2mass_0p22rms.fits'
input_fits_image_band3='./input/shift_gama12_h_54m_20160225_astro_2mass_0p21rms.fits'
input_fits_image_band4='./input/shift_i_gama12_i_band_ACAM_53min_20160226_astro_0p241rms.fits'
input_fits_image_band5='./input/G12v230_IRAC_Mosaic_36.fits'
input_fits_image_band6='./input/G12v230_IRAC_Mosaic_45.fits'

band4_present=1  #=================================================================1:yes 0:no (I band)
band5_present=1  #=================================================================1:yes 0:no (3.6 band)
band6_present=1  #=================================================================1:yes 0:no (4.5 band)



#montage.mSubimage(input_fits_image_band5, './G12_3p6_trimmed.fits', ra=, dec=, xsize=0.0023)






aplpy.make_rgb_cube([input_fits_image_band1, input_fits_image_band2, input_fits_image_band4], 'G12_cube.fits')   #R, G, B
#aplpy.make_rgb_image('G12_cube.fits','G12_cube.png')
aplpy.make_rgb_image('G12_cube.fits','G12_cube.png', vmin_b=500.0, vmax_b=3000.0, vmax_r=73.0, vmin_r=-20.0)
#aplpy.make_rgb_image('G12_JHK_cube.fits', 'G12_JHK_cube.png', pmin_r=0., pmax_r=80., pmin_g=0., pmax_g=80., pmin_b=0., pmax_b=80.)




rgb_image = aplpy.FITSFigure('./G12_cube_2d.fits')
rgb_image.show_rgb('G12_cube.png')
#rgb_image.show_contour(input_fits_image_band5, levels=3, colors='red', linewidths=0.5)

#rgb_image.recenter(176.65903,-0.19764512, radius=0.036)
rgb_image.recenter(176.65903,-0.19764512, width=0.066, height=0.07)

rgb_image.add_scalebar(1.0/60.0)
rgb_image.scalebar.set_label("1'")
rgb_image.scalebar.set_color('white')
rgb_image.add_grid()
rgb_image.grid.set_alpha(1.0)
rgb_image.grid.set_linewidth(0.1)
rgb_image.set_title('G12 Field (Red: Ks, Green: J, Blue: I)', size=30)     #===========================================================HERE



rgb_image.show_circles(xw=[176.64603256046072,176.68504501029554,176.65874742868365,176.67851964323904,176.62934142423563,176.64372442456266,176.63162917076352,176.63429564271362,176.64149668580038,176.65191760135275,176.64106489822882,176.65969317184147,176.62702702085502,176.64852297197268,176.65087108786838,176.65001600660236,176.63125579358706,176.66122009712774,176.644618444814,176.63982089341866,176.68010411785622,176.68559529174294,176.64871077225922,176.63019641282642,176.65157663993446,176.67582192666669,176.66121354815863,176.66462092063728,176.67904284233305,176.67929687641174,176.65922618878898,176.6464865770106,176.67924504111446,176.6407182357656,176.63831897010172,176.6283675000455,176.637349462315,176.63464174036085,176.64856633252901,176.6549271809142,176.63330287081646,176.62749640284486,176.63546467775572,176.63154466771033,176.68639896691005,176.64325627456518,176.63041936031473,176.68162293630755,176.6811115545791,176.65820561046806,176.67176402388318,176.62478520180565,176.67822345904617,176.6334717132025,176.64338980122176,176.6837941911642,176.67010315980409,176.66531712932792,176.62665065788713,176.68506611133617,176.6622490135289,176.63592108915913,176.62960184931313], yw=[-0.23081408667090023,-0.16128787117638405,-0.1612819363559743,-0.1716231939544636,-0.17180245550501505,-0.17183240388240764,-0.17326568413024826,-0.1733098707550809,-0.17389112518735306,-0.17465127994213883,-0.17640863257571035,-0.17744812037252186,-0.17843628649166626,-0.1786734119306139,-0.1794227306812054,-0.1796794373892558,-0.17981230119695144,-0.17977352102615787,-0.17977345883834753,-0.1801981791841189,-0.1820170449766747,-0.18299049391399935,-0.18324826842943356,-0.18400661095190743,-0.18560287342622095,-0.18747328535428806,-0.1877346286753715,-0.18800361389190337,-0.1881571203543267,-0.1895021359003232,-0.19094602497559007,-0.19200152810484195,-0.19245186278959375,-0.19293641862986685,-0.19873667779833712,-0.20093568118161315,-0.20211165890235355,-0.20131688923601987,-0.20311466387052676,-0.20382436489730443,-0.20356484117644846,-0.2058143369692708,-0.2080482961990978,-0.20810187297199484,-0.20824942701816704,-0.2084179662393047,-0.2086539256110933,-0.2087974802213631,-0.21029116971395018,-0.21045074386062385,-0.21481789537965995,-0.21572744441114947,-0.2171328127818847,-0.21857402257566627,-0.2227639158838681,-0.2234551870286781,-0.2237706158200797,-0.22607459779264089,-0.2263437037972162,-0.22866398359377807,-0.16465568561388033,-0.16626493118659136,-0.16699112238584593], radius=0.00123251, color='yellow')








rgb_image.save('test.eps')

